# 冰箱溫度控制器 IC 系統規格書

## 1. 專案概述

### 1.1 目的
設計一個使用 SKY130 PDK 的數位溫度控制器 IC，用於家用冰箱的精確溫度控制。此設計將展示從 RTL 到 GDSII 的完整數位 IC 設計流程。

### 1.2 主要特色
- 數位 PID 控制演算法
- SPI 介面溫度感測器讀取
- PWM 壓縮機控制
- 七段顯示器溫度顯示
- 智慧除霜功能
- 低功耗設計

## 2. 系統需求

### 2.1 功能需求
| 參數 | 規格 | 備註 |
|------|------|------|
| 溫度控制範圍 | -20°C ~ +10°C | 涵蓋冷凍與冷藏 |
| 控制精度 | ±0.5°C | 穩態誤差 |
| 響應時間 | < 5 分鐘 | 達到設定溫度90% |
| 溫度顯示解析度 | 0.1°C | 七段顯示器 |
| 更新頻率 | 1 Hz | 控制迴路更新率 |

### 2.2 電氣規格
| 參數 | 最小值 | 典型值 | 最大值 | 單位 |
|------|--------|--------|--------|------|
| 核心電壓 (VDD) | 1.62 | 1.8 | 1.98 | V |
| I/O 電壓 (VDDIO) | 2.97 | 3.3 | 3.63 | V |
| 工作溫度 | -40 | 25 | 85 | °C |
| 系統時脈 | - | 10 | - | MHz |
| 功耗 | - | 5 | 10 | mW |

### 2.3 介面規格

#### 2.3.1 輸入信號
| 信號名稱 | 類型 | 描述 |
|----------|------|------|
| clk | 數位輸入 | 10 MHz 系統時脈 |
| rst_n | 數位輸入 | 低電平有效重置 |
| adc_miso | 數位輸入 | ADC SPI 資料輸入 |
| door_sensor | 數位輸入 | 門開啟感測器 |
| button_up | 數位輸入 | 溫度上調按鈕 |
| button_down | 數位輸入 | 溫度下調按鈕 |
| button_mode | 數位輸入 | 模式切換按鈕 |

#### 2.3.2 輸出信號
| 信號名稱 | 類型 | 描述 |
|----------|------|------|
| adc_mosi | 數位輸出 | ADC SPI 資料輸出 |
| adc_sclk | 數位輸出 | ADC SPI 時脈 |
| adc_cs_n | 數位輸出 | ADC 晶片選擇 |
| compressor_pwm | 數位輸出 | 壓縮機 PWM 控制 |
| defrost_heater | 數位輸出 | 除霜加熱器控制 |
| alarm | 數位輸出 | 警報輸出 |
| seven_seg[6:0] | 數位輸出 | 七段顯示器段控制 |
| digit_sel[3:0] | 數位輸出 | 數位選擇(多工) |
| status_led[2:0] | 數位輸出 | 狀態 LED |

## 3. 功能描述

### 3.1 溫度感測
- 使用 12-bit ADC (ADC128S022 相容介面)
- SPI 通訊協定，最高 1 MHz
- 溫度轉換公式：
  ```
  Temperature(°C) = (ADC_Value × Vref / 4096 - 0.5) × 100
  其中 Vref = 3.3V
  ```

### 3.2 PID 控制器
- 數位 PID 實現，16-bit 定點運算
- 參數範圍：
  - Kp: 0.1 ~ 10.0 (預設: 2.0)
  - Ki: 0.01 ~ 1.0 (預設: 0.1)
  - Kd: 0.01 ~ 1.0 (預設: 0.05)
- 採樣時間: 1 秒
- 抗積分飽和 (Anti-windup) 功能

### 3.3 壓縮機控制
- PWM 頻率: 1 kHz
- 佔空比範圍: 0% ~ 100%
- 最小開啟時間: 3 分鐘
- 最小關閉時間: 3 分鐘
- 軟啟動: 10 秒內從 0% 漸增到目標值

### 3.4 除霜控制
- 自動除霜週期: 每 8 小時
- 除霜持續時間: 最長 30 分鐘
- 除霜終止條件: 蒸發器溫度 > 5°C
- 除霜期間壓縮機關閉

### 3.5 使用者介面
- 4 位數七段顯示器顯示溫度 (XX.X°C)
- 按鈕功能：
  - UP/DOWN: 調整設定溫度 (±0.5°C/次)
  - MODE: 切換顯示模式 (當前/設定/錯誤代碼)
- LED 指示：
  - 綠色: 正常運行
  - 黃色: 除霜中
  - 紅色: 警報狀態

### 3.6 保護功能
- 高溫警報: > 10°C 持續 10 分鐘
- 低溫警報: < -25°C
- 門開啟警報: 開門超過 2 分鐘
- 感測器故障檢測

## 4. 設計約束

### 4.1 時序約束
- 系統時脈: 10 MHz ± 100 ppm
- SPI 時脈: 最高 1 MHz
- PWM 解析度: 10-bit (1024 級)
- 設置時間: > 2 ns
- 保持時間: > 1 ns

### 4.2 面積約束
- 核心面積目標: < 0.5 mm²
- I/O pad ring: 標準 SKY130 I/O
- 總晶片面積: < 1 mm²

### 4.3 功耗約束
- 動態功耗: < 5 mW @ 10 MHz
- 靜態功耗: < 1 mW
- 待機模式功耗: < 100 μW

## 5. 測試需求

### 5.1 功能測試
1. 溫度控制精度測試
2. PID 參數調整測試
3. 除霜功能測試
4. 使用者介面測試
5. 警報功能測試

### 5.2 效能測試
1. 功耗測量
2. 時序分析
3. 溫度穩定性測試
4. 長時間運行測試

### 5.3 可靠性測試
1. 電源電壓變化測試 (±10%)
2. 溫度範圍測試 (-40°C ~ 85°C)
3. ESD 保護測試

## 6. 開發計畫

### 6.1 里程碑
1. **M1**: RTL 設計完成 (第 2 週)
2. **M2**: 功能驗證完成 (第 4 週)
3. **M3**: 合成優化完成 (第 5 週)
4. **M4**: 實體設計完成 (第 7 週)
5. **M5**: 最終驗證完成 (第 8 週)

### 6.2 交付項目
1. RTL 原始碼 (Verilog)
2. 測試平台與測試案例
3. 合成腳本與報告
4. GDSII 檔案
5. 設計文件與使用手冊

## 7. 風險評估

### 7.1 技術風險
- PID 參數調校可能需要實際系統測試
- 溫度感測器精度受環境影響
- 功耗可能超過目標

### 7.2 緩解措施
- 提供參數調整介面
- 增加溫度校正功能
- 實施低功耗設計技術

## 8. 參考資料

1. SKY130 Process Design Kit Documentation
2. ADC128S022 Datasheet
3. Digital PID Controller Design Guidelines
4. OpenLane Flow Documentation

---

文件版本: 1.0  
最後更新: 2024-12-19  
作者: IC 設計團隊